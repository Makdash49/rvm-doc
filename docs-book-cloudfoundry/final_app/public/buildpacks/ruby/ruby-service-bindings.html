<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Configure Service Connections for Ruby |
    Cloud Foundry Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  <script type="text/javascript">
if (window.location.host === 'docs.cloudfoundry.org') {
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22181585-2']);
  _gaq.push(['_setDomainName', 'cloudfoundry.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
  })();
}
</script>

<!-- CrazyEgg Tracking Script -->
<script type="text/javascript">
if (window.location.host === 'docs.cloudfoundry.org') {
  setTimeout(function() {
    var a = document.createElement("script");
    var b = document.getElementsByTagName("script")[0];
    a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0020/8294.js?" + Math.floor(new Date().getTime() / 3600000);
    a.async = true;
    a.type = "text/javascript";
    b.parentNode.insertBefore(a, b)
  }, 1);
}
</script>

<script type="text/javascript">
if (window.location.host === 'docs.cloudfoundry.org') {
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
}
</script>


</head>

<body class="buildpacks buildpacks_ruby buildpacks_ruby_ruby-service-bindings has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "cloudfoundry.org";
    </script>

       
    <header class="header header-layout">
      <h1 class="logo">
        <a href="/">Cloud Foundry Documentation</a>
      </h1>
      
      <div class="header-links js-bar-links">
        <div class="btn-menu" data-behavior="MenuMobile"></div>
        
        <div class="header-item">
          <a href="https://www.cloudfoundry.org/contribute/" target="_blank">Get Involved</a>
        </div>
        <div class="searchbox header-item">
  <form method="get" action="/search">
    <input name="q" placeholder="Search" class="search-box" />
  </form>
</div>

      </div>
    </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav collapsible nav-container" role="navigation" data-behavior="Collapsible">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>
      <li class="has_submenu">
        <a href="/deploying/index.html">Deploying Cloud Foundry</a>
        <ul>
          <li class="has_submenu">
            <a href="/deploying/aws/index.html">Preparing to Deploy on Amazon Web Services</a>
            <ul>
              <li>
                <a href="/deploying/aws/setup_aws.html">Setting up an AWS Environment for Cloud Foundry with BOSH AWS Bootstrap</a>
              </li>
              <li>
                <a href="/deploying/aws/setup_bosh_aws.html">Deploying BOSH on AWS</a>
              </li>
              <li>
                <a href="/deploying/aws/cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for AWS</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/deploying/openstack/index.html">Preparing to Deploy on OpenStack</a>
            <ul>
              <li>
                <a href="/deploying/openstack/validate_openstack.html">Validate your OpenStack Instance</a>
              </li>
              <li>
                <a href="/deploying/openstack/security_group.html">Security Group for Cloud Foundry on OpenStack</a>
              </li>
              <li>
                <a href="/deploying/openstack/set-up-dns.html">DNS Setup for Cloud Foundry on OpenStack</a>
              </li>
              <li>
                <a href="/deploying/openstack/required-flavors.html">Required Instance Flavors for Cloud Foundry on OpenStack</a>
              </li>
              <li>
                <a href="/deploying/openstack/cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for OpenStack</a>
              </li>
              <li class="has_submenu">
                <span>Additional OpenStack Configuration</span>
                <ul>
                  <li>
                    <a href="/deploying/openstack/troubleshooting.html">Troubleshooting Cloud Foundry on OpenStack</a>
                  </li>
                  <li>
                    <a href="/deploying/openstack/using_swift_blobstore.html">Using OpenStack Swift as a Cloud Foundry Blobstore</a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/deploying/vsphere/index.html">Preparing to Deploy on vSphere</a>
            <ul>
              <li>
                <a href="https://bosh.io/docs/init-vsphere.html">Initializing BOSH on vSphere</a>
              </li>
              <li>
                <a href="/deploying/common/vsphere-vcloud-cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for vSphere</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/deploying/vcloud/index.html">Preparing to Deploy on vCloud</a>
            <ul>
              <li>
                <a href="/deploying/vcloud/setup_vcloud.html">Setting up vCloud Air or vCloud Virtual Data Center Environment</a>
              </li>
              <li>
                <a href="https://bosh.io/docs/init-vcloud.html">Initializing BOSH on vCloud</a>
              </li>
              <li>
                <a href="/deploying/common/vsphere-vcloud-cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for vCloud Air or vCloud Director</a>
              </li>
            </ul>
          </li>

          <li class="has_submenu">
            <a href="/deploying/boshlite/index.html">Preparing to Deploy on BOSH-Lite</a>
            <ul>
              <li>
                <a href="/deploying/boshlite/create_a_manifest.html">Create a Deployment Manifest for Cloud Foundry on BOSH-Lite</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/deploying/common/deploy.html">Deploying Cloud Foundry</a>
          </li>
        <li class="has_submenu">
          <span>Additional Configuration</span>
          <ul>
          <li>
            <a href="/concepts/high-availability.html">High Availability in Cloud Foundry</a>
          </li>
          <li>
            <a href="/deploying/common/log_drain_blacklists.html">Log Drain Blacklist Configuration</a>
          </li>
          <li>
            <a href="/deploying/common/consul-security.html">Security Configuration for Consul</a>
          </li>
          <li>
            <a href="https://github.com/cloudfoundry-community/cf-services-contrib-release">Deploying Community Services</a>
          </li>
          <li>
            <a href="/deploying/common/cc-blobstore-config.html">Cloud Controller Blobstore Configuration</a>
          </li>
          </ul>
        </ul>
      </li>
      <li class="has_submenu">
        <span>Cloud Foundry Command Line Interface (cf CLI)</span>
        <ul>
          <li>
            <a href="/cf-cli/install-go-cli.html">Installing the cf CLI</a>
          </li>
          <li>
            <a href="/cf-cli/getting-started.html">Getting Started with the cf CLI</a>
          </li>
          <li>
            <a href="/cf-cli/http-proxy.html">Using the cf CLI with an HTTP Proxy Server</a>
          </li>
          <li>
            <a href="/cf-cli/self-signed.html">Using the cf CLI with a Self-Signed Certificate</a>
          </li>
          <li>
            <a href="/cf-cli/use-cli-plugins.html">Using cf CLI Plugins</a>
          </li>
          <li>
            <a href="/cf-cli/develop-cli-plugins.html">Developing cf CLI Plugins</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/app-startup.html">About Starting Applications</a>
          </li>
          <li>
            <a href="/cf-cli/cf-help.html">cf CLI Reference Guide</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Develop and Manage Applications
        </span>
        <ul>
          <li>
            <a href="/devguide/deploy-apps/prepare-to-deploy.html">Considerations for Designing and Running an Application in the Cloud</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/index.html">Understanding Application Deployment</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/deploy-app.html">Deploy an Application</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/large-app-deploy.html">Deploying a Large Application</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/manifest.html">Deploying with Application Manifests</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/app-lifecycle.html">Application Container Lifecycle</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/cf-scale.html">Scaling an Application Using cf scale</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/routes-domains.html">Routes and Domains</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/stacks.html">Changing Stacks</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/environment-variable.html">Cloud Foundry Environment Variables</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/blue-green.html">Using Blue-Green Deployment to Reduce Downtime and Risk</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/streaming-logs.html">Application Logging in Cloud Foundry</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/troubleshoot-app-health.html">Troubleshooting Application Deployment and Health</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/app-ssh-overview.html">Application SSH Overview</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/ssh-apps.html">Accessing Apps with Diego SSH</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/ssh-services.html">Accessing Services with Diego SSH</a>
          </li>
          <li>
            <a href="/running/cf-api-endpoint.html">Identifying your Cloud Foundry API Endpoint and Version</a>
          </li>
          <li class="has_submenu">
            <span>Integrating Service Instances with Applications</span>
            <ul>
              <li>
                <a href="/devguide/services/">Services Overview</a>
              </li>
              <li>
                <a href="/devguide/services/application-binding.html">Delivering Service Credentials to an Application</a>
              </li>
              <li>
                <a href="/devguide/services/managing-services.html">Managing Service Instances with the CLI</a>
              </li>
              <li>
                <a href="/devguide/services/service-keys.html">Managing Service Keys</a>
              </li>
              <li>
                <a href="/devguide/services/user-provided.html">User-Provided Service Instances</a>
              </li>
              <li>
                <a href="/devguide/services/route-binding.html">Manage Application Requests with Route Services</a>
              </li>
              <li>
                <a href="/devguide/services/play-service-bindings.html">Configuring Play Framework Service Connections</a>
              </li>
              <li>
                <a href="/devguide/services/migrate-db.html">Migrating a Database in Cloud Foundry</a>
              </li>
              <li>
                <a href="/devguide/services/log-management.html">Streaming Application Logs to Log Management Services</a>
              </li>
              <li>
                <a href="/devguide/services/log-management-thirdparty-svc.html">Service-Specific Instructions for Streaming Application Logs</a>
              </li>
              <li>
                <a href="/devguide/services/integrate-splunk.html">Integrating Cloud Foundry with Splunk</a>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Custom Services
        </span>
        <ul>
          <li>
            <a href="/services/">Custom Services</a>
          </li>
          <li>
            <a href="/services/overview.html">Overview</a>
          </li>
          <li>
            <a href="/services/api.html">Service Broker API</a>
          </li>
          <li>
            <a href="/services/managing-service-brokers.html">Managing Service Brokers</a>
          </li>
          <li>
            <a href="/services/access-control.html">Access Control</a>
          </li>
          <li>
            <a href="/services/catalog-metadata.html">Catalog Metadata</a>
          </li>
          <li>
            <a href="/services/binding-credentials.html">Binding Credentials</a>
          </li>
          <li>
            <a href="/services/dashboard-sso.html">Dashboard Single Sign-On</a>
          </li>
          <li>
            <a href="/services/examples.html">Example Service Brokers</a>
          </li>
          <li>
            <a href="/services/app-log-streaming.html">Application Log Streaming</a>
          </li>
          <li>
            <a href="/services/route-services.html">Route Services</a>
          </li>
          <li>
            <a href="/services/supporting-multiple-cf-instances.html">Supporting Multiple Cloud Foundry Instances</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Buildpacks
        </span>
        <ul>
          <li>
            <a href="/buildpacks/">Buildpacks</a>
          </li>
          <li>
            <a href="/buildpacks/detection.html">Buildpack Detection</a>
          </li>
          <li>
            <a href="/buildpacks/custom.html">Custom Buildpacks</a>
          </li>
          <li>
            <a href="/buildpacks/proxy-usage.html">Proxy Usage</a>
          </li>
          <li>
            <a href="/buildpacks/depend-pkg-offline.html">Packaging Dependencies for Offline Buildpacks</a>
          </li>
          <li>
            <a href="/buildpacks/supported-binary-dependencies.html">Supported Binary Dependencies</a>
          </li>
          <li>
            <a href="/buildpacks/prod-server.html">Configuring a Production Server</a>
          </li>
          <li>
          <a href="/buildpacks/merging_upstream.html">Merging from Upstream Buildpacks</a>
          </li>
          <li>
          <a href="/buildpacks/upgrading_dependency_versions.html">Upgrading Dependency Versions</a>
         </li>
          <li class="has_submenu">
            <a href="/buildpacks/java/index.html">Java Buildpack</a>
            <ul>
              <li>
                <a href="/buildpacks/java/bosh_custom_trusted_certs.html">BOSH Custom Trusted Certificate Support</a>
              </li>
              <li>
                <a href="/buildpacks/java/java-tips.html">Tips for Java Developers</a>
              </li>
              <li>
                <a href="/buildpacks/java/sts.html">Cloud Foundry Eclipse Plugin</a>
              </li>
              <li>
                <a href="/buildpacks/java/java-client.html">Cloud Foundry Java Client Library</a>
              </li>
              <li>
                <a href="/buildpacks/java/build-tool-int.html">Build Tool Integration</a>
              </li>
              <li>
                <a href="/buildpacks/java/gsg-grails.html">Getting Started Deploying Grails Apps</a>
              </li>
              <li>
                <a href="/buildpacks/java/gsg-spring.html">Getting Started Deploying Spring Apps</a>
              </li>
              <li>
                <a href="/buildpacks/java/gsg-ratpack.html">Getting Started Deploying Ratpack Apps</a>
              </li>
              <li>
                <a href="/buildpacks/java/grails-service-bindings.html">Configure Service Connections for Grails</a>
              </li>
              <li>
                <a href="/buildpacks/java/spring-service-bindings.html">Configure Service Connections for Spring</a>
              </li>
              <li>
                <a href="/buildpacks/java/play-service-bindings.html">Configure Service Connections for Play</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/buildpacks/ruby/index.html">
              Ruby Buildpack
            </a>
            <ul>
              <li>
                <a href="/buildpacks/ruby/ruby-tips.html">Tips for Ruby Developers</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/gsg-ruby.html">Getting Started Deploying Ruby Apps</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/gsg-ror.html">Getting Started Deploying Ruby on Rails Apps</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/sample-ror.html">Deploy a Sample Ruby on Rails App</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/rake-config.html">Configure Rake Tasks for Deployed Apps</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/ruby-environment.html">Environment Variables Defined by the Ruby Buildpack</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/ruby-service-bindings.html">Configure Service Connections for Ruby</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/rvm.html">Mark's Ruby Version Manager Documentation</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/buildpacks/node/index.html">Node.js Buildpack</a>
            <ul>
              <li>
                <a href="/buildpacks/node/node-tips.html">Tips for Node.js Applications</a>
              </li>
              <li>
                <a href="/buildpacks/node/node-environment.html">Environment Variables Defined by the Node Buildpack</a>
              </li>
              <li>
                <a href="/buildpacks/node/node-service-bindings.html">Configure Service Connections for Node.js</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/buildpacks/binary/index.html">Binary Buildpack</a>
          </li>
          <li>
            <a href="/buildpacks/go/index.html">Go Buildpack</a>
          </li>
          <li class="has_submenu">
            <a href="/buildpacks/php/index.html">
              PHP Buildpack
            </a>
            <ul>
              <li>
                <a href="/buildpacks/php/gsg-php-usage.html">Deploying and Developing PHP Apps</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-config.html">PHP Buildpack Configuration</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-composer.html">Composer</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-sessions.html">Sessions</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-newrelic.html">New Relic</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-tips.html">Tips for PHP Developers</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/buildpacks/python/index.html">Python Buildpack</a>
          </li>
          <li>
            <a href="/buildpacks/staticfile/index.html">Staticfile Buildpack</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <a href="/running/">Run and Troubleshoot Cloud Foundry</a>
        <ul>
          <li>
            <a href="/running/managing-cf/logging.html">Cloud Foundry Logging</a>
          </li>
          <li>
            <a href="/running/managing-cf/logging-config.html">Configuring System Logging</a>
          </li>
          <li>
            <a href="/running/managing-cf/usage-events.html">Usage Events and Billing</a>
          </li>
          <li>
            <a href="/running/config-ssh.html">Configuring SSH Access for Cloud Foundry</a>
          </li>
          <li>
            <a href="/running/monitoring-test.html">Monitoring and Testing Diego Components</a>
          </li>
          <li>
            <a href="/running/troubleshooting.html">Troubleshooting Cloud Foundry</a>
          </li>
          <li>
            <a href="/running/troubleshooting/troubleshooting-apps.html">Troubleshooting Applications</a>
          </li>
          <li>
            <a href="/running/troubleshooting/troubleshooting-warden-services.html">Troubleshooting Wardenized Services</a>
          </li>
          <li>
            <a href="/running/troubleshooting/troubleshooting-diego-windows.html">Troubleshooting Diego for Windows</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>Administer Cloud Foundry</span>
        <ul>
          <li>
            <a href="/adminguide/buildpacks.html">Adding Buildpacks to Cloud Foundry</a>
          </li>
          <li>
            <a href="/adminguide/manage-domains-routes.html">Managing Domains and Routes</a>
          </li>
          <li>
            <a href="/adminguide/cli-user-management.html">Creating and Managing Users with the cf CLI</a>
          </li>
          <li>
            <a href="/adminguide/uaa-user-management.html">Creating and Managing Users with the UAA CLI (UAAC)</a>
          </li>
          <li>
            <a href="/adminguide/quota-plans.html">Creating and Modifying Quota Plans</a>
          </li>
          <li>
            <a href="/adminguide/notifications.html">Getting Started with the Notifications Service</a>
          </li>
          <li>
            <a href="/adminguide/app-sec-groups.html">Application Security Groups</a>
          </li>
          <li>
            <a href="/adminguide/listing-feature-flags.html">Feature Flags</a>
          </li>
          <li>
            <a href="/adminguide/enabling_ipv6.html">Enabling IPv6 for Hosted Applications</a>
          </li>
          <li>
            <a href="/adminguide/securing-traffic.html">Securing Traffic into Cloud Foundry</a>
          </li>
          <li>
            <a href="/adminguide/apps-enable-diego.html">Migrating Apps to Diego</a>
          </li>
          <li>
            <a href="/adminguide/hm-notifications.html">Configuring Health Monitor Notifications</a>
          </li>
          <li>
            <a href="/adminguide/supporting-websockets.html">Supporting WebSockets</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Cloud Foundry Concepts
        </span>
        <ul>
          <!--
            <li>
            <a href="/concepts/index.html">Cloud Foundry Concepts (landing)</a>
            </li>
          -->
          </li>
          <li>
            <a href="/concepts/overview.html">Cloud Foundry Overview</a>
          </li>
          <li>
            <a href="/concepts/architecture/">Cloud Foundry Components</a>
          </li>
          <li>
            <a href="/concepts/diego/diego-architecture.html">Diego Architecture</a>
          </li>
          <li>
            <a href="/concepts/diego/dea-vs-diego.html">Differences Between DEA and Diego Architectures</a>
          </li>
          <li>
            <a href="/concepts/diego/diego-auction.html">How the Diego Auction Allocates Jobs</a>
          </li>
          <li>
            <a href="/concepts/how-applications-are-staged.html">How Applications Are Staged</a>
          </li>
          <li>
            <a href="/concepts/diego/ssh-conceptual.html">Understanding Application SSH</a>
          </li>
          <li>
            <a href="/concepts/roles.html">Orgs, Spaces, Roles, and Permissions</a>
          </li>
          <li>
            <a href="/concepts/security.html">Cloud Foundry Security</a>
          </li>
            <li>
            <a href="/concepts/http-routing.html">HTTP Routing</a>
          </li>
          <li>
            <a href="/concepts/stacks.html">Stacks</a>
          </li>
          <li>
            <a href="/concepts/docker.html">Using Docker in Cloud Foundry</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <span>
          Logging and Metrics in Cloud Foundry
        </span>
        <ul>
          <li>
            <a href="/loggregator/architecture.html">Overview of the Loggregator System</a>
          </li>
          <li>
            <a href="/loggregator/cli-plugin.html">Installing the Loggregator Plugin for CF CLI</a>
          </li>
          <li>
            <a href="/loggregator/cc-uaa-logging.html">Security Event Logging for Cloud Controller and UAA</a>
          </li>
          <li>
            <a href="/loggregator/all_metrics.html">Cloud Foundry Component Metrics</a>
          </li>
          <li>
            <a href="/loggregator/dea-metrics.html">DEA Architecture Component Metrics</a>
          </li>
          <li>
            <a href="/loggregator/log-ops-guide.html">Loggregator Guide for Cloud Foundry Operators</a>
          </li>
          <li>
            <a href="/loggregator/data-sources.html">Cloud Foundry Data Sources</a>
          </li>
          <li>
            <a href="/loggregator/nozzle-tutorial.html">Deploying a Nozzle to the Loggregator Firehose</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/api/uaa/index.html">UAA API</a>
      </li>
      <li>
        <a href="http://bosh.io/docs/">BOSH</a>
      </li>
    </ul>
  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" >
    Configure Service Connections for Ruby
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li><a href="#cf-app-utils">Query VCAP_SERVICES with cf-app-utils</a></li>
<li><a href="#vcap-services-defines-database-url">VCAP_SERVICES defines DATABASE_URL</a></li>
<li><a href="#rails-applications-have-autoconfigured-database-yml">Older Rails Applications Have Auto-Configured database.yml</a></li>
<li><a href="#configuring-non-rails-applications">Configure Non-Rails Applications</a></li>
<li><a href="#migrate">Seed or Migrate Database</a></li>
<li>
<a href="#troubleshooting">Troubleshooting</a><ul>
<li><a href="#view-env">View Environment Variables</a></li>
<li><a href="#view-logs">View Logs</a></li>
</ul>
</li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p><strong></strong></p>

<p>After you create a service instance and bind it to an application, you must
configure the application to connect to the service.</p>

<h2><a id='cf-app-utils'></a>Query VCAP_SERVICES with cf-app-utils</h2>

<p>The <code>cf-apps-utils</code> gem allows your application to search for credentials from
the <code>VCAP_SERVICES</code> environment variable by name, tag, or label.</p>

<ul>
<li><a href="https://github.com/cloudfoundry/cf-app-utils-ruby">cf-app-utils-ruby</a></li>
</ul>

<h2><a id='vcap-services-defines-database-url'></a>VCAP_SERVICES defines DATABASE_URL</h2>

<p>At runtime, the Ruby buildpack creates a <code>DATABASE_URL</code> environment variable
for every Ruby application based on the
<a href="../../devguide/deploy-apps/environment-variable.html#VCAP-SERVICES">VCAP_SERVICES</a> environment variable.</p>

<p>Example VCAP_SERVICES:</p>
<pre class="highlight plaintext"><code>VCAP_SERVICES =
{
  "elephantsql": [
    {
      "name": "elephantsql-c6c60",
      "label": "elephantsql",
      "credentials": {
        "uri": "postgres://exampleuser:examplepass@babar.elephantsql.com:5432/exampledb"
      }
    }
  ]
}
</code></pre>

<p>Based on this <code>VCAP_SERVICES</code>, the Ruby buildpack creates the following
<code>DATABASE_URL</code> environment variable:</p>
<pre class="highlight plaintext"><code>DATABASE_URL = postgres://exampleuser:examplepass@babar.elephantsql.com:5432/exampledb
</code></pre>

<p>The Ruby buildpack uses the structure of the <code>VCAP_SERVICES</code> environment
variable to populate <code>DATABASE_URL</code>.
Any service containing a JSON object with the following form will be recognized
by Cloud Foundry as a candidate for <code>DATABASE_URL</code>:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"some-service"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"credentials"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;some database URL&gt;"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Cloud Foundry uses the first candidate found to populate <code>DATABASE_URL</code>.</p>

<h2><a id='rails-applications-have-autoconfigured-database-yml'></a>Older Rails Applications Have Auto-Configured database.yml</h2>

<p>On Rails versions 4 or before, the Ruby buildpack replaces your <code>database.yml</code> with one based on the <code>DATABASE_URL</code> variable.</p>

<p class='note'><strong>Note</strong>: On Rails versions 4 or before, Ruby buildpack ignores the contents of any <code>database.yml</code> that you provide and overwrites it during staging.</p>

<h2><a id='configuring-non-rails-applications'></a>Configure Non-Rails Applications</h2>

<p>Non-Rails applications can also access the <code>DATABASE_URL</code> variable.</p>

<p>If you have more than one service with credentials, only the first will be
populated into <code>DATABASE_URL</code>.
To access other credentials, you can inspect the <code>VCAP_SERVICES</code> environment
variable.</p>
<pre class="highlight ruby"><code><span class="n">vcap_services</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="no">ENV</span><span class="p">[</span><span class="s1">'VCAP_SERVICES'</span><span class="p">])</span>
</code></pre>

<p>Use the hash key for the service to obtain the connection credentials from
<code>VCAP_SERVICES</code>.</p>

<ul>
<li><p>For services that use the <a href="http://docs.cloudfoundry.org/services/api.html">v2 format</a>, the hash key is the name
of the service.</p></li>
<li><p>For services that use the <a href="http://docs.cloudfoundry.org/services/api-v1.html">v1 format</a>, the hash key is formed
by combining the service provider and version, in the format PROVIDER-VERSION.</p></li>
</ul>

<p>For example, the service provider &ldquo;p-mysql&rdquo; with version &ldquo;n/a&rdquo; forms the hash
  key <code>p-mysql-n/a</code>.</p>

<h2><a id='migrate'></a>Seed or Migrate Database</h2>

<p>Before you can use your database the first time, you must create and populate
or migrate it.
For more information, see <a href="../../devguide/services/migrate-db.html">Migrating a Database in Cloud Foundry</a>.</p>

<h2><a id='troubleshooting'></a>Troubleshooting</h2>

<p>To aid in troubleshooting issues connecting to your service, you can examine
the environment variables and log messages Cloud Foundry records for your
application.</p>

<h3><a id='view-env'></a>View Environment Variables</h3>

<p>Use the <code>cf env</code> command to view the Cloud Foundry environment variables for
your application.
<code>cf env</code> displays the following environment variables:</p>

<ul>
<li>The <code>VCAP_SERVICES</code> variables existing in the container environment</li>
<li>The user-provided variables set using the <code>cf set-env</code> command</li>
</ul>

<pre class="terminal">
  $ cf env my-app
  Getting env variables for app my-app in org My-Org / space development as admin...
  OK

  System-Provided:
  {
    "VCAP_SERVICES": {
      "p-mysql-n/a": [
        {
          "credentials": {
              "uri":"postgres://lrra:e6B-X@p-mysqlprovider.example.com:5432/lraa
          },
          "label": "p-mysql-n/a",
          "name": "p-mysql",
          "syslog_drain_url": "",
          "tags": ["postgres","postgresql","relational"]
        }
      ]
    }
  }

  User-Provided:
  my-env-var: 100
  my-drain: http://drain.example.com
</pre>

<h3><a id='view-logs'></a>View Logs</h3>

<p>Use the <code>cf logs</code> command to view the Cloud Foundry log messages for your
application.
You can direct current logging to standard output, or you can dump the most
recent logs to standard output.</p>

<p>Run <code>cf logs APPNAME</code> to direct current logging to standard output:</p>

<pre class="terminal">
  $ cf logs my-app
  Connected, tailing logs for app my-app in org My-Org / space development as admin...
  1:27:19.72 [App/0]  OUT [CONTAINER]  org.apache.coyote.http11.Http11Protocol  INFO  Starting ProtocolHandler ["http-bio-61013"]
  1:27:19.77 [App/0]  OUT [CONTAINER]   org.apache.catalina.startup.Catalina     INFO  Server startup in 10427 ms
</pre>

<p>Run <code>cf logs APPNAME --recent</code> to dump the most recent logs to standard output:
<pre class="terminal">
  $ cf logs my-app --recent
  Connected, dumping recent logs for app my-app in org My-Org / space development as admin...
  1:27:15.93 [App/0]  OUT 15,935  INFO EmbeddedDatabaseFactory:124 - Creating embedded database &#39;SkyNet&#39;
  1:27:16.31 [App/0]  OUT 16,318  INFO LocalEntityManagerFactory:287 - Building TM container EntityManagerFactory for unit &#39;default&#39;
  1:27:16.50 [App/0]  OUT 16,505  INFO Version:37 - HCANN001: Hibernate Commons Annotations {4.0.1.Final}
  1:27:16.51 [App/0]  OUT 16,517  INFO Version:41 - HHH412: Hibernate Core {4.1.9.Final}
  1:27:16.95 [App/0]  OUT 16,957  INFO SkyNet-Online:73 - HHH268: Transaction strategy: org.hibernate.internal.TransactionFactory
  1:27:16.96 [App/0]  OUT 16,963  INFO InintiateTerminatorT1000Deployment:48 - HHH000397: Using TranslatorFactory
  1:27:17.02 [App/0]  OUT 17,026  INFO Version:27 - HV001: Hibernate Validator 4.3.0.Final
</pre></p>

<p>If you encounter the error, &ldquo;A fatal error has occurred. Please see the Bundler
troubleshooting documentation,&rdquo; update your version of bundler and run <code>bundle install</code>.</p>

<pre class="terminal">
  $ gem update bundler
  $ gem update --system
  $ bundle install
</pre>

        <a id='repo-link' href='http://github.com/cloudfoundry/docs-buildpacks/tree/master/ruby/ruby-service-bindings.html.md.erb'>View the source for this page in GitHub</a>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='/'>Cloud Foundry Documentation</a>
  &copy; 2016 <a href='http://cloudfoundry.org'>Cloud Foundry Foundation</a>. All Rights Reserved.
</div>
<div class="support">
  <a href="https://www.cloudfoundry.org/contribute/" target="_blank">Get Involved</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
