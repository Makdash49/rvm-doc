<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Tips for Ruby Developers |
    Cloud Foundry Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  <script type="text/javascript">
if (window.location.host === 'docs.cloudfoundry.org') {
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22181585-2']);
  _gaq.push(['_setDomainName', 'cloudfoundry.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
  })();
}
</script>

<!-- CrazyEgg Tracking Script -->
<script type="text/javascript">
if (window.location.host === 'docs.cloudfoundry.org') {
  setTimeout(function() {
    var a = document.createElement("script");
    var b = document.getElementsByTagName("script")[0];
    a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0020/8294.js?" + Math.floor(new Date().getTime() / 3600000);
    a.async = true;
    a.type = "text/javascript";
    b.parentNode.insertBefore(a, b)
  }, 1);
}
</script>

<script type="text/javascript">
if (window.location.host === 'docs.cloudfoundry.org') {
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
}
</script>


</head>

<body class="buildpacks buildpacks_ruby buildpacks_ruby_ruby-tips has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "cloudfoundry.org";
    </script>

       
    <header class="header header-layout">
      <h1 class="logo">
        <a href="/">Cloud Foundry Documentation</a>
      </h1>
      
      <div class="header-links js-bar-links">
        <div class="btn-menu" data-behavior="MenuMobile"></div>
        
        <div class="header-item">
          <a href="https://www.cloudfoundry.org/contribute/" target="_blank">Get Involved</a>
        </div>
        <div class="searchbox header-item">
  <form method="get" action="/search">
    <input name="q" placeholder="Search" class="search-box" />
  </form>
</div>

      </div>
    </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav collapsible nav-container" role="navigation" data-behavior="Collapsible">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>
      <li class="has_submenu">
        <a href="/deploying/index.html">Deploying Cloud Foundry</a>
        <ul>
          <li class="has_submenu">
            <a href="/deploying/aws/index.html">Preparing to Deploy on Amazon Web Services</a>
            <ul>
              <li>
                <a href="/deploying/aws/setup_aws.html">Setting up an AWS Environment for Cloud Foundry with BOSH AWS Bootstrap</a>
              </li>
              <li>
                <a href="/deploying/aws/setup_bosh_aws.html">Deploying BOSH on AWS</a>
              </li>
              <li>
                <a href="/deploying/aws/cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for AWS</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/deploying/openstack/index.html">Preparing to Deploy on OpenStack</a>
            <ul>
              <li>
                <a href="/deploying/openstack/validate_openstack.html">Validate your OpenStack Instance</a>
              </li>
              <li>
                <a href="/deploying/openstack/security_group.html">Security Group for Cloud Foundry on OpenStack</a>
              </li>
              <li>
                <a href="/deploying/openstack/set-up-dns.html">DNS Setup for Cloud Foundry on OpenStack</a>
              </li>
              <li>
                <a href="/deploying/openstack/required-flavors.html">Required Instance Flavors for Cloud Foundry on OpenStack</a>
              </li>
              <li>
                <a href="/deploying/openstack/cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for OpenStack</a>
              </li>
              <li class="has_submenu">
                <span>Additional OpenStack Configuration</span>
                <ul>
                  <li>
                    <a href="/deploying/openstack/troubleshooting.html">Troubleshooting Cloud Foundry on OpenStack</a>
                  </li>
                  <li>
                    <a href="/deploying/openstack/using_swift_blobstore.html">Using OpenStack Swift as a Cloud Foundry Blobstore</a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/deploying/vsphere/index.html">Preparing to Deploy on vSphere</a>
            <ul>
              <li>
                <a href="https://bosh.io/docs/init-vsphere.html">Initializing BOSH on vSphere</a>
              </li>
              <li>
                <a href="/deploying/common/vsphere-vcloud-cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for vSphere</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/deploying/vcloud/index.html">Preparing to Deploy on vCloud</a>
            <ul>
              <li>
                <a href="/deploying/vcloud/setup_vcloud.html">Setting up vCloud Air or vCloud Virtual Data Center Environment</a>
              </li>
              <li>
                <a href="https://bosh.io/docs/init-vcloud.html">Initializing BOSH on vCloud</a>
              </li>
              <li>
                <a href="/deploying/common/vsphere-vcloud-cf-stub.html">Customizing the Cloud Foundry Deployment Manifest for vCloud Air or vCloud Director</a>
              </li>
            </ul>
          </li>

          <li class="has_submenu">
            <a href="/deploying/boshlite/index.html">Preparing to Deploy on BOSH-Lite</a>
            <ul>
              <li>
                <a href="/deploying/boshlite/create_a_manifest.html">Create a Deployment Manifest for Cloud Foundry on BOSH-Lite</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/deploying/common/deploy.html">Deploying Cloud Foundry</a>
          </li>
        <li class="has_submenu">
          <span>Additional Configuration</span>
          <ul>
          <li>
            <a href="/concepts/high-availability.html">High Availability in Cloud Foundry</a>
          </li>
          <li>
            <a href="/deploying/common/log_drain_blacklists.html">Log Drain Blacklist Configuration</a>
          </li>
          <li>
            <a href="/deploying/common/consul-security.html">Security Configuration for Consul</a>
          </li>
          <li>
            <a href="https://github.com/cloudfoundry-community/cf-services-contrib-release">Deploying Community Services</a>
          </li>
          <li>
            <a href="/deploying/common/cc-blobstore-config.html">Cloud Controller Blobstore Configuration</a>
          </li>
          </ul>
        </ul>
      </li>
      <li class="has_submenu">
        <span>Cloud Foundry Command Line Interface (cf CLI)</span>
        <ul>
          <li>
            <a href="/cf-cli/install-go-cli.html">Installing the cf CLI</a>
          </li>
          <li>
            <a href="/cf-cli/getting-started.html">Getting Started with the cf CLI</a>
          </li>
          <li>
            <a href="/cf-cli/http-proxy.html">Using the cf CLI with an HTTP Proxy Server</a>
          </li>
          <li>
            <a href="/cf-cli/self-signed.html">Using the cf CLI with a Self-Signed Certificate</a>
          </li>
          <li>
            <a href="/cf-cli/use-cli-plugins.html">Using cf CLI Plugins</a>
          </li>
          <li>
            <a href="/cf-cli/develop-cli-plugins.html">Developing cf CLI Plugins</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/app-startup.html">About Starting Applications</a>
          </li>
          <li>
            <a href="/cf-cli/cf-help.html">cf CLI Reference Guide</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Develop and Manage Applications
        </span>
        <ul>
          <li>
            <a href="/devguide/deploy-apps/prepare-to-deploy.html">Considerations for Designing and Running an Application in the Cloud</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/index.html">Understanding Application Deployment</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/deploy-app.html">Deploy an Application</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/large-app-deploy.html">Deploying a Large Application</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/manifest.html">Deploying with Application Manifests</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/app-lifecycle.html">Application Container Lifecycle</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/cf-scale.html">Scaling an Application Using cf scale</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/routes-domains.html">Routes and Domains</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/stacks.html">Changing Stacks</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/environment-variable.html">Cloud Foundry Environment Variables</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/blue-green.html">Using Blue-Green Deployment to Reduce Downtime and Risk</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/streaming-logs.html">Application Logging in Cloud Foundry</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/troubleshoot-app-health.html">Troubleshooting Application Deployment and Health</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/app-ssh-overview.html">Application SSH Overview</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/ssh-apps.html">Accessing Apps with Diego SSH</a>
          </li>
          <li>
            <a href="/devguide/deploy-apps/ssh-services.html">Accessing Services with Diego SSH</a>
          </li>
          <li>
            <a href="/running/cf-api-endpoint.html">Identifying your Cloud Foundry API Endpoint and Version</a>
          </li>
          <li class="has_submenu">
            <span>Integrating Service Instances with Applications</span>
            <ul>
              <li>
                <a href="/devguide/services/">Services Overview</a>
              </li>
              <li>
                <a href="/devguide/services/application-binding.html">Delivering Service Credentials to an Application</a>
              </li>
              <li>
                <a href="/devguide/services/managing-services.html">Managing Service Instances with the CLI</a>
              </li>
              <li>
                <a href="/devguide/services/service-keys.html">Managing Service Keys</a>
              </li>
              <li>
                <a href="/devguide/services/user-provided.html">User-Provided Service Instances</a>
              </li>
              <li>
                <a href="/devguide/services/route-binding.html">Manage Application Requests with Route Services</a>
              </li>
              <li>
                <a href="/devguide/services/play-service-bindings.html">Configuring Play Framework Service Connections</a>
              </li>
              <li>
                <a href="/devguide/services/migrate-db.html">Migrating a Database in Cloud Foundry</a>
              </li>
              <li>
                <a href="/devguide/services/log-management.html">Streaming Application Logs to Log Management Services</a>
              </li>
              <li>
                <a href="/devguide/services/log-management-thirdparty-svc.html">Service-Specific Instructions for Streaming Application Logs</a>
              </li>
              <li>
                <a href="/devguide/services/integrate-splunk.html">Integrating Cloud Foundry with Splunk</a>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Custom Services
        </span>
        <ul>
          <li>
            <a href="/services/">Custom Services</a>
          </li>
          <li>
            <a href="/services/overview.html">Overview</a>
          </li>
          <li>
            <a href="/services/api.html">Service Broker API</a>
          </li>
          <li>
            <a href="/services/managing-service-brokers.html">Managing Service Brokers</a>
          </li>
          <li>
            <a href="/services/access-control.html">Access Control</a>
          </li>
          <li>
            <a href="/services/catalog-metadata.html">Catalog Metadata</a>
          </li>
          <li>
            <a href="/services/binding-credentials.html">Binding Credentials</a>
          </li>
          <li>
            <a href="/services/dashboard-sso.html">Dashboard Single Sign-On</a>
          </li>
          <li>
            <a href="/services/examples.html">Example Service Brokers</a>
          </li>
          <li>
            <a href="/services/app-log-streaming.html">Application Log Streaming</a>
          </li>
          <li>
            <a href="/services/route-services.html">Route Services</a>
          </li>
          <li>
            <a href="/services/supporting-multiple-cf-instances.html">Supporting Multiple Cloud Foundry Instances</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Buildpacks
        </span>
        <ul>
          <li>
            <a href="/buildpacks/">Buildpacks</a>
          </li>
          <li>
            <a href="/buildpacks/detection.html">Buildpack Detection</a>
          </li>
          <li>
            <a href="/buildpacks/custom.html">Custom Buildpacks</a>
          </li>
          <li>
            <a href="/buildpacks/proxy-usage.html">Proxy Usage</a>
          </li>
          <li>
            <a href="/buildpacks/depend-pkg-offline.html">Packaging Dependencies for Offline Buildpacks</a>
          </li>
          <li>
            <a href="/buildpacks/supported-binary-dependencies.html">Supported Binary Dependencies</a>
          </li>
          <li>
            <a href="/buildpacks/prod-server.html">Configuring a Production Server</a>
          </li>
          <li>
          <a href="/buildpacks/merging_upstream.html">Merging from Upstream Buildpacks</a>
          </li>
          <li>
          <a href="/buildpacks/upgrading_dependency_versions.html">Upgrading Dependency Versions</a>
         </li>
          <li class="has_submenu">
            <a href="/buildpacks/java/index.html">Java Buildpack</a>
            <ul>
              <li>
                <a href="/buildpacks/java/bosh_custom_trusted_certs.html">BOSH Custom Trusted Certificate Support</a>
              </li>
              <li>
                <a href="/buildpacks/java/java-tips.html">Tips for Java Developers</a>
              </li>
              <li>
                <a href="/buildpacks/java/sts.html">Cloud Foundry Eclipse Plugin</a>
              </li>
              <li>
                <a href="/buildpacks/java/java-client.html">Cloud Foundry Java Client Library</a>
              </li>
              <li>
                <a href="/buildpacks/java/build-tool-int.html">Build Tool Integration</a>
              </li>
              <li>
                <a href="/buildpacks/java/gsg-grails.html">Getting Started Deploying Grails Apps</a>
              </li>
              <li>
                <a href="/buildpacks/java/gsg-spring.html">Getting Started Deploying Spring Apps</a>
              </li>
              <li>
                <a href="/buildpacks/java/gsg-ratpack.html">Getting Started Deploying Ratpack Apps</a>
              </li>
              <li>
                <a href="/buildpacks/java/grails-service-bindings.html">Configure Service Connections for Grails</a>
              </li>
              <li>
                <a href="/buildpacks/java/spring-service-bindings.html">Configure Service Connections for Spring</a>
              </li>
              <li>
                <a href="/buildpacks/java/play-service-bindings.html">Configure Service Connections for Play</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/buildpacks/ruby/index.html">
              Ruby Buildpack
            </a>
            <ul>
              <li>
                <a href="/buildpacks/ruby/ruby-tips.html">Tips for Ruby Developers</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/gsg-ruby.html">Getting Started Deploying Ruby Apps</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/gsg-ror.html">Getting Started Deploying Ruby on Rails Apps</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/sample-ror.html">Deploy a Sample Ruby on Rails App</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/rake-config.html">Configure Rake Tasks for Deployed Apps</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/ruby-environment.html">Environment Variables Defined by the Ruby Buildpack</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/ruby-service-bindings.html">Configure Service Connections for Ruby</a>
              </li>
              <li>
                <a href="/buildpacks/ruby/rvm.html">Mark's Ruby Version Manager Documentation</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="/buildpacks/node/index.html">Node.js Buildpack</a>
            <ul>
              <li>
                <a href="/buildpacks/node/node-tips.html">Tips for Node.js Applications</a>
              </li>
              <li>
                <a href="/buildpacks/node/node-environment.html">Environment Variables Defined by the Node Buildpack</a>
              </li>
              <li>
                <a href="/buildpacks/node/node-service-bindings.html">Configure Service Connections for Node.js</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/buildpacks/binary/index.html">Binary Buildpack</a>
          </li>
          <li>
            <a href="/buildpacks/go/index.html">Go Buildpack</a>
          </li>
          <li class="has_submenu">
            <a href="/buildpacks/php/index.html">
              PHP Buildpack
            </a>
            <ul>
              <li>
                <a href="/buildpacks/php/gsg-php-usage.html">Deploying and Developing PHP Apps</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-config.html">PHP Buildpack Configuration</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-composer.html">Composer</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-sessions.html">Sessions</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-newrelic.html">New Relic</a>
              </li>
              <li>
                <a href="/buildpacks/php/gsg-php-tips.html">Tips for PHP Developers</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/buildpacks/python/index.html">Python Buildpack</a>
          </li>
          <li>
            <a href="/buildpacks/staticfile/index.html">Staticfile Buildpack</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <a href="/running/">Run and Troubleshoot Cloud Foundry</a>
        <ul>
          <li>
            <a href="/running/managing-cf/logging.html">Cloud Foundry Logging</a>
          </li>
          <li>
            <a href="/running/managing-cf/logging-config.html">Configuring System Logging</a>
          </li>
          <li>
            <a href="/running/managing-cf/usage-events.html">Usage Events and Billing</a>
          </li>
          <li>
            <a href="/running/config-ssh.html">Configuring SSH Access for Cloud Foundry</a>
          </li>
          <li>
            <a href="/running/monitoring-test.html">Monitoring and Testing Diego Components</a>
          </li>
          <li>
            <a href="/running/troubleshooting.html">Troubleshooting Cloud Foundry</a>
          </li>
          <li>
            <a href="/running/troubleshooting/troubleshooting-apps.html">Troubleshooting Applications</a>
          </li>
          <li>
            <a href="/running/troubleshooting/troubleshooting-warden-services.html">Troubleshooting Wardenized Services</a>
          </li>
          <li>
            <a href="/running/troubleshooting/troubleshooting-diego-windows.html">Troubleshooting Diego for Windows</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>Administer Cloud Foundry</span>
        <ul>
          <li>
            <a href="/adminguide/buildpacks.html">Adding Buildpacks to Cloud Foundry</a>
          </li>
          <li>
            <a href="/adminguide/manage-domains-routes.html">Managing Domains and Routes</a>
          </li>
          <li>
            <a href="/adminguide/cli-user-management.html">Creating and Managing Users with the cf CLI</a>
          </li>
          <li>
            <a href="/adminguide/uaa-user-management.html">Creating and Managing Users with the UAA CLI (UAAC)</a>
          </li>
          <li>
            <a href="/adminguide/quota-plans.html">Creating and Modifying Quota Plans</a>
          </li>
          <li>
            <a href="/adminguide/notifications.html">Getting Started with the Notifications Service</a>
          </li>
          <li>
            <a href="/adminguide/app-sec-groups.html">Application Security Groups</a>
          </li>
          <li>
            <a href="/adminguide/listing-feature-flags.html">Feature Flags</a>
          </li>
          <li>
            <a href="/adminguide/enabling_ipv6.html">Enabling IPv6 for Hosted Applications</a>
          </li>
          <li>
            <a href="/adminguide/securing-traffic.html">Securing Traffic into Cloud Foundry</a>
          </li>
          <li>
            <a href="/adminguide/apps-enable-diego.html">Migrating Apps to Diego</a>
          </li>
          <li>
            <a href="/adminguide/hm-notifications.html">Configuring Health Monitor Notifications</a>
          </li>
          <li>
            <a href="/adminguide/supporting-websockets.html">Supporting WebSockets</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Cloud Foundry Concepts
        </span>
        <ul>
          <!--
            <li>
            <a href="/concepts/index.html">Cloud Foundry Concepts (landing)</a>
            </li>
          -->
          </li>
          <li>
            <a href="/concepts/overview.html">Cloud Foundry Overview</a>
          </li>
          <li>
            <a href="/concepts/architecture/">Cloud Foundry Components</a>
          </li>
          <li>
            <a href="/concepts/diego/diego-architecture.html">Diego Architecture</a>
          </li>
          <li>
            <a href="/concepts/diego/dea-vs-diego.html">Differences Between DEA and Diego Architectures</a>
          </li>
          <li>
            <a href="/concepts/diego/diego-auction.html">How the Diego Auction Allocates Jobs</a>
          </li>
          <li>
            <a href="/concepts/how-applications-are-staged.html">How Applications Are Staged</a>
          </li>
          <li>
            <a href="/concepts/diego/ssh-conceptual.html">Understanding Application SSH</a>
          </li>
          <li>
            <a href="/concepts/roles.html">Orgs, Spaces, Roles, and Permissions</a>
          </li>
          <li>
            <a href="/concepts/security.html">Cloud Foundry Security</a>
          </li>
            <li>
            <a href="/concepts/http-routing.html">HTTP Routing</a>
          </li>
          <li>
            <a href="/concepts/stacks.html">Stacks</a>
          </li>
          <li>
            <a href="/concepts/docker.html">Using Docker in Cloud Foundry</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <span>
          Logging and Metrics in Cloud Foundry
        </span>
        <ul>
          <li>
            <a href="/loggregator/architecture.html">Overview of the Loggregator System</a>
          </li>
          <li>
            <a href="/loggregator/cli-plugin.html">Installing the Loggregator Plugin for CF CLI</a>
          </li>
          <li>
            <a href="/loggregator/cc-uaa-logging.html">Security Event Logging for Cloud Controller and UAA</a>
          </li>
          <li>
            <a href="/loggregator/all_metrics.html">Cloud Foundry Component Metrics</a>
          </li>
          <li>
            <a href="/loggregator/dea-metrics.html">DEA Architecture Component Metrics</a>
          </li>
          <li>
            <a href="/loggregator/log-ops-guide.html">Loggregator Guide for Cloud Foundry Operators</a>
          </li>
          <li>
            <a href="/loggregator/data-sources.html">Cloud Foundry Data Sources</a>
          </li>
          <li>
            <a href="/loggregator/nozzle-tutorial.html">Deploying a Nozzle to the Loggregator Firehose</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/api/uaa/index.html">UAA API</a>
      </li>
      <li>
        <a href="http://bosh.io/docs/">BOSH</a>
      </li>
    </ul>
  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" >
    Tips for Ruby Developers
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li><a href="#bundler">Application Bundling</a></li>
<li><a href="#config">Rack Config File</a></li>
<li><a href="#precompile">Asset Precompilation</a></li>
<li>
<a href="#rake">Running Rake Tasks</a><ul><li><a href="#migrate-ruby-db">Example: Invoking a Rake database migration task at application startup</a></li></ul>
</li>
<li>
<a href="#workers">Rails 3 Worker Tasks</a><ul>
<li><a href="#worker-libs">Choose a Worker Task Library</a></li>
<li><a href="#example-app">Create an Example Application</a></li>
<li><a href="#test">Test the Application</a></li>
<li><a href="#scale">Scale Workers</a></li>
</ul>
</li>
<li><a href="#rails-4">Use rails_serve_static_assets on Rails 4</a></li>
<li><a href="#buildpack">Additional Ruby Buildpack Information</a></li>
<li>
<a href="#env-var">Environment Variables</a><ul>
<li><a href="#BUNDLE-BIN-PATH">BUNDLE_BIN_PATH</a></li>
<li><a href="#BUNDLE-GEMFILE">BUNDLE_GEMFILE</a></li>
<li><a href="#BUNDLE-WITHOUT">BUNDLE_WITHOUT</a></li>
<li><a href="#DATABASE-URL">DATABASE_URL</a></li>
<li><a href="#GEM-HOME">GEM_HOME</a></li>
<li><a href="#GEM-PATH">GEM_PATH</a></li>
<li><a href="#RACK-ENV">RACK_ENV</a></li>
<li><a href="#RAILS-ENV">RAILS_ENV</a></li>
<li><a href="#RUBYOPT">RUBYOPT</a></li>
</ul>
</li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p><strong></strong></p>

<p>This page has information specific to deploying Rack, Rails, or Sinatra
applications.</p>

<h2><a id='bundler'></a>Application Bundling</h2>

<p>You must run <a href="http://gembundler.com/">Bundler</a> to create a <code>Gemfile</code>
and a <code>Gemfile.lock</code>.
These files must be in your application before you push to Cloud Foundry.</p>

<h2><a id='config'></a>Rack Config File</h2>

<p>For Rack and Sinatra, you must have a <code>config.ru</code> file. For example:</p>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'./hello_world'</span>
<span class="n">run</span> <span class="no">HelloWorld</span><span class="p">.</span><span class="nf">new</span>
</code></pre>

<h2><a id='precompile'></a>Asset Precompilation</h2>

<p>Cloud Foundry supports the Rails asset pipeline.
If you do not precompile assets before deploying your application, Cloud Foundry
will precompile them when staging the application.
Precompiling before deploying reduces the time it takes to stage an application.</p>

<p>Use the following command to precompile assets before deployment:</p>

<pre class="terminal">
rake assets:precompile
</pre>

<p>Note that the Rake precompile task reinitializes the Rails application.
This could pose a problem if initialization requires service connections or
environment checks that are unavailable during staging.
To prevent reinitialization during precompilation, add the following line to
<code>application.rb</code>:</p>
<pre class="highlight ruby"><code><span class="n">config</span><span class="p">.</span><span class="nf">assets</span><span class="p">.</span><span class="nf">initialize_on_precompile</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>

<p>If the <code>assets:precompile</code> task fails, Cloud Foundry uses live compilation mode,
the alternative to asset precompilation.
In this mode, assets are compiled when they are loaded for the first time.
You can force live compilation by adding the following line to <code>application.rb</code>.</p>
<pre class="highlight ruby"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">assets</span><span class="p">.</span><span class="nf">compile</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>

<h2><a id='rake'></a>Running Rake Tasks</h2>

<p>Cloud Foundry does not provide a mechanism for running a Rake task on a deployed
application.
If you need to run a Rake task that must be performed in the Cloud Foundry
environment, rather than locally before deploying or redeploying, you can
configure the command that Cloud Foundry uses to start the application to invoke
the Rake task.</p>

<p>An application&rsquo;s start command is configured in the application&rsquo;s manifest file,
<code>manifest.yml</code>, using the <code>command</code> attribute.</p>

<p>If you have previously deployed the application, the application manifest should
already exist.
There are two ways to create a manifest.
You can manually create the file and save it in the application&rsquo;s root directory
before you deploy the application for the first time.
If you do not manually create the manifest file, the cf CLI will prompt you to
supply deployment settings when you first push the application, and will create
and save the manifest file for you, with the settings you specified
interactively.
For more information about application manifests, and supported attributes, see
<a href="../../devguide/deploy-apps/manifest.html">Deploying with Application Manifests</a>.</p>

<h3><a id='migrate-ruby-db'></a>Example: Invoking a Rake database migration task at application startup</h3>

<p>The following is an example of the &ldquo;migrate frequently&rdquo; method described in the
<a href="../../devguide/services/migrate-db.html#frequent-migration">Migrating a Database in Cloud Foundry</a> topic.</p>

<ol>
<li>Create a Rakefile if one does not already exist, and add it to your application directory. </li>
<li><p>In your Rakefile, add a Rake task to limit an idempotent command to the first instance of a deployed application:</p>
<pre class="highlight plaintext"><code>namespace :cf do
  desc "Only run on the first application instance"
  task :on_first_instance do
    instance_index = JSON.parse(ENV["VCAP_APPLICATION"])["instance_index"] rescue nil
    exit(0) unless instance_index == 0
  end
end
</code></pre></li>
<li><p>Add the task to the <code>manifest.yml</code> file, referencing the idempotent command <code>rake db:migrate</code> with the <code>command</code> attribute.</p>
<pre class="highlight plaintext"><code>---
applications:
- name: my-rails-app
  command: bundle exec rake cf:on_first_instance db:migrate &amp;&amp; bundle exec rails s -p $PORT -e $RAILS_ENV
</code></pre></li>
<li><p>Update the application using <code>cf push</code>.</p></li>
</ol>

<h2><a id='workers'></a>Rails 3 Worker Tasks</h2>

<p>This section shows you how to create and deploy an example Rails application
that uses a worker library to defer a task that a separate application executes.</p>

<p>The guide also describes how to scale the resources available to the worker
application.</p>

<p class="note"><strong>Note</strong>: Most worker tasks do not serve external requests. Use the <code>--no-route</code> flag with the <code>cf push</code> command, or <code>no-route: true</code> in the application manifest, to suppress route creation and remove existing routes.</p>

<h3><a id='worker-libs'></a>Choose a Worker Task Library</h3>

<p>You must choose a worker task library.
The table below summarizes the three main libraries available for Ruby / Rails:</p>

<table border="1" class="nice">
  <tr>
    <th>Library</th>
    <th>Description</th>
  </tr>
  <tr>
 <td><a href="https://github.com/collectiveidea/delayed_job">Delayed::Job</a></td>
    <td>A direct extraction from <a href="http://www.shopify.com/">Shopify</a> where the job table is responsible for a multitude of core tasks.</td>
  </tr>
  <tr>
    <td><a href="https://github.com/defunkt/resque">Resque</a></td>
    <td>A Redis-backed library for creating background jobs, placing those jobs on multiple queues, and processing them later.</td>
  </tr>
  <tr>
    <td><a href="https://github.com/mperham/sidekiq">Sidekiq</a></td>
    <td>Uses threads to handle many messages at the same time in the same process. It does not require Rails but will integrate tightly with Rails 3 to make background message processing dead simple. This library is also Redis-backed and is actually somewhat compatible with Resque messaging.</td>
  </tr>
</table>

<p>For other alternatives, see
<a href="https://www.ruby-toolbox.com/categories/Background_Jobs">https://www.ruby-toolbox.com/categories/Background_Jobs</a>.</p>

<h3><a id='example-app'></a>Create an Example Application</h3>

<p>For the purposes of the example application, we will use Sidekiq.</p>

<p>First, create a Rails application with an arbitrary model called &ldquo;Things&rdquo;:</p>

<pre class="terminal">
$ rails create rails-sidekiq
$ cd rails-sidekiq
$ rails g model Thing title:string description:string
</pre>

<p>Add <code>sidekiq</code> and <code>uuidtools</code> to the Gemfile:</p>
<pre class="highlight ruby"><code><span class="n">source</span> <span class="s1">'https://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'rails'</span><span class="p">,</span> <span class="s1">'3.2.9'</span>
<span class="n">gem</span> <span class="s1">'mysql2'</span>

<span class="n">group</span> <span class="ss">:assets</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s1">'sass-rails'</span><span class="p">,</span>   <span class="s1">'~&gt; 3.2.3'</span>
  <span class="n">gem</span> <span class="s1">'coffee-rails'</span><span class="p">,</span> <span class="s1">'~&gt; 3.2.1'</span>
  <span class="n">gem</span> <span class="s1">'uglifier'</span><span class="p">,</span> <span class="s1">'&gt;= 1.0.3'</span>
<span class="k">end</span>

<span class="n">gem</span> <span class="s1">'jquery-rails'</span>
<span class="n">gem</span> <span class="s1">'sidekiq'</span>
<span class="n">gem</span> <span class="s1">'uuidtools'</span>
</code></pre>

<p>Install the bundle.</p>

<pre class="terminal">
$ bundle install
</pre>

<p>Create a worker (in app/workers) for Sidekiq to carry out its tasks:</p>

<pre class="terminal">
$ touch app/workers/thing_worker.rb
</pre>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">ThingWorker</span>

  <span class="kp">include</span> <span class="no">Sidekiq</span><span class="o">::</span><span class="no">Worker</span>

  <span class="k">def</span> <span class="nf">perform</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

    <span class="n">count</span><span class="p">.</span><span class="nf">times</span> <span class="k">do</span>

      <span class="n">thing_uuid</span> <span class="o">=</span> <span class="no">UUIDTools</span><span class="o">::</span><span class="no">UUID</span><span class="p">.</span><span class="nf">random_create</span><span class="p">.</span><span class="nf">to_s</span>
      <span class="no">Thing</span><span class="p">.</span><span class="nf">create</span> <span class="ss">:title</span> <span class="o">=&gt;</span><span class="s2">"New Thing (</span><span class="si">#{</span><span class="n">thing_uuid</span><span class="si">}</span><span class="s2">)"</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span>
<span class="s2">"Description for thing </span><span class="si">#{</span><span class="n">thing_uuid</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">end</span>

  <span class="k">end</span>

<span class="k">end</span>
</code></pre>

<p>This worker will create n number of things, where n is the value passed to the
worker.</p>

<p>Create a controller for &ldquo;Things&rdquo;:</p>

<pre class="terminal">
$ rails g controller Thing
</pre>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">ThingController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">new</span>
    <span class="no">ThingWorker</span><span class="p">.</span><span class="nf">perform_async</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">redirect_to</span> <span class="s1">'/thing'</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@things</span> <span class="o">=</span> <span class="no">Thing</span><span class="p">.</span><span class="nf">all</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre>

<p>Add a view to inspect our collection of &ldquo;Things&rdquo;:</p>

<pre class="terminal">
$ mkdir app/views/things
$ touch app/views/things/index.html.erb
</pre>
<pre class="highlight plaintext"><code>nil
</code></pre>

<h4><a id='deploy'></a>Deploy the Application</h4>

<p>This application needs to be deployed twice for it to work, once as a Rails web
application and once as a standalone Ruby application.
The easiest way to do this is to keep separate Cloud Foundry manifests for each
application type:</p>

<p>Web Manifest: Save this as <code>web-manifest.yml</code>:</p>
<pre class="highlight yaml"><code><span class="nn">---</span>
<span class="s">applications</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">sidekiq</span>
  <span class="s">memory</span><span class="pi">:</span> <span class="s">256M</span>
  <span class="s">instances</span><span class="pi">:</span> <span class="s">1</span>
  <span class="s">host</span><span class="pi">:</span> <span class="s">sidekiq</span>
  <span class="s">domain</span><span class="pi">:</span> <span class="s">${target-base}</span>
  <span class="s">path</span><span class="pi">:</span> <span class="s">.</span>
  <span class="s">services</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">sidekiq-mysql</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">sidekiq-redis</span><span class="pi">:</span>
</code></pre>

<p>Worker Manifest: Save this as <code>worker-manifest.yml</code>:</p>
<pre class="highlight yaml"><code><span class="nn">---</span>
<span class="s">applications</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">sidekiq-worker</span>
  <span class="s">memory</span><span class="pi">:</span> <span class="s">256M</span>
  <span class="s">instances</span><span class="pi">:</span> <span class="s">1</span>
  <span class="s">path</span><span class="pi">:</span> <span class="s">.</span>
  <span class="s">command</span><span class="pi">:</span> <span class="s">bundle exec sidekiq</span>
  <span class="s">no-route</span><span class="pi">:</span> <span class="s">true</span>
  <span class="s">services</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">sidekiq-redis</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">sidekiq-mysql</span><span class="pi">:</span>
</code></pre>

<p>Since the url &ldquo;sidekiq.cloudfoundry.com&rdquo; is probably already taken, change it
in <code>web-manifest.yml</code> first, then push the application with both manifest
files:</p>

<pre class="terminal">
$ cf push -f web-manifest.yml
$ cf push -f worker-manifest.yml
</pre>

<p>If the cf CLI asks for a URL for the worker application, select &ldquo;none&rdquo;.</p>

<h3><a id='test'></a>Test the Application</h3>

<p>Test the application by visiting the new action on the &ldquo;Thing&rdquo; controller at
the assigned url.
In this example, the URL would be <code>http://sidekiq.cloudfoundry.com/thing/new</code>.</p>

<p>This will create a new Sidekiq job which will be queued in Redis, then picked
up by the worker application.
The browser is then redirected to <code>/thing</code> which will show the collection of
&ldquo;Things&rdquo;.</p>

<h3><a id='scale'></a>Scale Workers</h3>

<p>Use the <code>cf scale</code> command to change the number of Sidekiq workers.</p>

<p>Example:</p>

<pre class="terminal">
$ cf scale sidekiq-worker -i 2
</pre>

<h2><a id='rails-4'></a>Use rails_serve_static_assets on Rails 4</h2>

<p>By default Rails 4 returns a 404 if an asset is not handled via an external
proxy such as Nginx.
The <a href="https://rubygems.org/gems/rails_serve_static_assets"><code>rails_serve_static_assets</code></a>
gem enables your Rails server to deliver
static assets directly, instead of returning a 404.
You can use this capability to populate an edge cache CDN or serve files
directly from your web application.
The gem enables this behavior by setting the
<code>config.serve_static_assets</code> option to <code>true</code>, so you do not need to
configure it manually.</p>

<h2><a id='buildpack'></a>Additional Ruby Buildpack Information</h2>

<p>For information about using and extending the Ruby buildpack in Cloud Foundry,
see the <a href="https://github.com/cloudfoundry/ruby-buildpack">ruby-buildpack GitHub repo</a>.</p>

<p>You can find current information about this buildpack on the Ruby buildpack
<a href="https://github.com/cloudfoundry/ruby-buildpack/releases">release page</a> in
GitHub.</p>

<p>The buildpack uses a default Ruby version of <code>2.2.2</code>.
To override this value for your app, add a Ruby declaration in the Gemfile.
This also applies to using a JRuby interpreter.</p>

<h2><a id='env-var'></a>Environment Variables</h2>

<p>You can access environments variable programmatically. For example, you can
obtain <code>VCAP_SERVICES</code> as follows:</p>
<pre class="highlight plaintext"><code>ENV['VCAP_SERVICES']
</code></pre>

<p>Environment variables available to you include both those <a href="../../devguide/deploy-apps/environment-variable.html#app-system-env">defined by the system</a>
and those defined by the Ruby buildpack, as described below.</p>

<h3><a id='BUNDLE-BIN-PATH'></a>BUNDLE_BIN_PATH</h3>

<p>Location where Bundler installs binaries.</p>

<p><code>BUNDLE_BIN_PATH:/home/vcap/app/vendor/bundle/ruby/1.9.1/gems/bundler-1.3.2/bin/bundle</code></p>

<h3><a id='BUNDLE-GEMFILE'></a>BUNDLE_GEMFILE</h3>

<p>Path to application&rsquo;s Gemfile.</p>

<p><code>BUNDLE_GEMFILE:/home/vcap/app/Gemfile</code></p>

<h3><a id='BUNDLE-WITHOUT'></a>BUNDLE_WITHOUT</h3>

<p>The <code>BUNDLE_WITHOUT</code> environment variable causes Cloud Foundry to skip
installation of gems in excluded groups.
<code>BUNDLE_WITHOUT</code> is particularly useful for Rails applications, where there are
typically &ldquo;assets&rdquo; and &ldquo;development&rdquo; gem groups containing gems that are not
needed when the app runs in production</p>

<p>For information about using this variable, see <a href="http://blog.cloudfoundry.com/2012/10/02/polishing-cloud-foundrys-ruby-gem-support">http://blog.cloudfoundry.com/2012/10/02/polishing-cloud-foundrys-ruby-gem-support</a>.</p>

<p><code>BUNDLE_WITHOUT=assets</code></p>

<h3><a id='DATABASE-URL'></a>DATABASE_URL</h3>

<p>The Ruby buildpack looks at the database_uri for bound services to see if they
match known database types.
If there are known relational database services bound to the application, the
buildpack sets up the DATABASE_URL environment variable with the first one in
the list.</p>

<p>If your application depends on DATABASE_URL being set to the connection string
for your service, and Cloud Foundry does not set it, you can set this variable
manually.</p>

<p><code>$ cf set-env my_app_name DATABASE_URL mysql://b5d435f40dd2b2:ebfc00ac@us-cdbr-east-03.cleardb.com:3306/ad_c6f4446532610ab</code></p>

<h3><a id='GEM-HOME'></a>GEM_HOME</h3>

<p>Location where gems are installed.</p>

<p><code>GEM_HOME:/home/vcap/app/vendor/bundle/ruby/1.9.1</code></p>

<h3><a id='GEM-PATH'></a>GEM_PATH</h3>

<p>Location where gems can be found.</p>

<p><code>GEM_PATH=/home/vcap/app/vendor/bundle/ruby/1.9.1:</code></p>

<h3><a id='RACK-ENV'></a>RACK_ENV</h3>

<p>This variable specifies the Rack deployment environment: development,
deployment, or none.
This governs what middleware is loaded to run the application.</p>

<p><code>RACK_ENV=production</code></p>

<h3><a id='RAILS-ENV'></a>RAILS_ENV</h3>

<p>This variable specifies the Rails deployment environment: development, test, or
production.
This controls which of the environment-specific configuration files will govern
how the application will be executed.</p>

<p><code>RAILS_ENV=production</code></p>

<h3><a id='RUBYOPT'></a>RUBYOPT</h3>

<p>This Ruby environment variable defines command-line options passed to Ruby
interpreter.</p>

<p><code>RUBYOPT: -I/home/vcap/app/vendor/bundle/ruby/1.9.1/gems/bundler-1.3.2/lib -rbundler/setup</code></p>

        <a id='repo-link' href='http://github.com/cloudfoundry/docs-buildpacks/tree/master/ruby/ruby-tips.html.md.erb'>View the source for this page in GitHub</a>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='/'>Cloud Foundry Documentation</a>
  &copy; 2016 <a href='http://cloudfoundry.org'>Cloud Foundry Foundation</a>. All Rights Reserved.
</div>
<div class="support">
  <a href="https://www.cloudfoundry.org/contribute/" target="_blank">Get Involved</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
